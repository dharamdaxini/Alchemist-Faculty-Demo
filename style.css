/* --- GLOBAL THEME --- */
:root { 
    --bg: #05080f; --card-bg: #0b172a; --dock-bg: #0f203a; 
    --border: #1e2f4a; --accent: #38bdf8; --text-main: #f0f4f8; 
    --text-sub: #64748b; --green: #4ade80; --red: #f87171; --gold: #fbbf24;
    --font-ui: 'Inter', sans-serif; --font-book: 'Crimson Pro', serif;       
    --font-code: 'JetBrains Mono', monospace;
}

* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; user-select: none; }

body { 
    margin: 0; height: 100vh; background: var(--bg); color: var(--text-main); 
    font-family: var(--font-ui); overflow: hidden; display: flex; flex-direction: column; 
}

/* --- STAGE & POSITIONING --- */
#stage { 
    flex-grow: 1; 
    position: relative; 
    overflow: hidden; 
    perspective: 1000px; 
}

/* --- THE CARD (PINNED) --- */
.card { 
    position: absolute; 
    left: 50%; transform: translateX(-50%);
    width: 92%; max-width: 380px; 
    
    /* V159 ANCHOR: Sit exactly on the Dock Boundary */
    bottom: 220px; 
    top: 70px;
    
    background: var(--card-bg); 
    border-radius: 20px 20px 0 0; 
    border: 1px solid var(--border); border-bottom: none;
    
    display: flex; flex-direction: column; 
    box-shadow: 0 -10px 40px rgba(0,0,0,0.5); 
    
    /* THE PIVOT: Bottom Center of the Card Face */
    transform-origin: 50% 100%; 
    will-change: transform; 
    overflow: hidden;
}

.card-top { 
    flex-grow: 1; padding: 24px; 
    display: flex; flex-direction: column; 
    justify-content: center; align-items: center; 
    text-align: center; position: relative; 
}

/* --- TEXT FADE LOGIC --- */
.card-q { 
    font-family: var(--font-book); font-size: clamp(1.6rem, 5vmin, 2.2rem); 
    font-weight: 600; line-height: 1.3; color: #fff; 
    transition: opacity 0.05s linear; 
}

.card-overlay-text { 
    position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); 
    font-family: var(--font-book); font-size: 2.2rem; font-weight: 600; color: #fff; 
    opacity: 0; pointer-events: none; width: 90%; text-align: center; 
    text-shadow: 0 10px 30px rgba(0,0,0,0.9); 
    transition: opacity 0.05s linear;
}

/* --- OPTION DOCK & STACK --- */
.card-dock { 
    position: absolute; bottom: 0; left: 0; width: 100%;
    height: 220px; background: var(--dock-bg); 
    border-top: 2px solid var(--gold); /* THE YELLOW LINE */
    display: flex; flex-direction: column; 
    justify-content: center; 
    padding: 10px 0; transition: background 0.2s; z-index: 10;
}

.card-dock.analysis-mode { 
    background: rgba(251, 191, 36, 0.15); 
}

.dock-col { 
    display: flex; flex-direction: row; 
    align-items: center; justify-content: space-between;
    flex: 1; padding: 8px 24px; 
    border-bottom: 1px solid var(--border); 
    transition: background 0.2s;
}

.dock-col:last-child { border-bottom: none; }

.dock-label { 
    font-size: 0.6rem; font-weight: 800; color: var(--text-sub); 
    letter-spacing: 1px; text-transform: uppercase; 
    width: 60px; flex-shrink: 0; text-align: left; 
}

.dock-val { 
    font-family: var(--font-book); font-size: 1.1rem; 
    color: var(--text-main); font-weight: 600; 
    opacity: 0.8; text-align: right; line-height: 1.3; 
    flex: 1; padding-left: 12px;
    
    /* V159 TEXT PROTECTION */
    white-space: normal; 
    word-break: break-word; 
}

.dock-col.active { background: rgba(56, 189, 248, 0.1); }
.dock-col.active .dock-val { color: var(--accent); opacity: 1; }

/* --- SESSION TOOLS --- */
#header { 
    width: 100%; height: 70px; display: flex; 
    justify-content: space-between; align-items: center; 
    padding: 0 24px; z-index: 1000; 
}

.nav-back { 
    font-size: 0.75rem; color: var(--text-sub); 
    font-weight: 700; text-transform: uppercase; cursor: pointer; 
}

.stat-pill { 
    background: rgba(11, 23, 42, 0.8); 
    padding: 8px 16px; border-radius: 6px; 
    font-size: 0.75rem; border: 1px solid var(--border); 
    font-weight: 700; font-family: var(--font-code); 
}

.progress-line { 
    position: fixed; bottom: 0; left: 0; 
    height: 3px; background: var(--accent); 
    width: 0%; transition: width 0.4s; z-index: 100; 
}
